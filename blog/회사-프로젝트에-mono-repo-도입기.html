<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v3.1.1">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Seob&#39;log RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Seob&#39;log Atom Feed">



<link rel="search" type="application/opensearchdescription+xml" title="Seob&#39;log" href="/opensearch.xml">
<link rel="alternate" type="application/rss+xml" href="/algorithms/rss.xml" title="Seob&#39;log RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/algorithms/atom.xml" title="Seob&#39;log Atom Feed"><title data-rh="true">회사 프로젝트에 mono-repo 도입기 | Seob&#x27;log</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://seobie.github.io/blog/회사-프로젝트에-mono-repo-도입기"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="회사 프로젝트에 mono-repo 도입기 | Seob&#x27;log"><meta data-rh="true" name="description" content="mono-repo 도입을 결정하게 된 이유"><meta data-rh="true" property="og:description" content="mono-repo 도입을 결정하게 된 이유"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2021-11-06T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/seobie"><meta data-rh="true" property="article:tag" content="mono-repo,lerna,yarn workspace"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://seobie.github.io/blog/회사-프로젝트에-mono-repo-도입기"><link data-rh="true" rel="alternate" href="https://seobie.github.io/blog/회사-프로젝트에-mono-repo-도입기" hreflang="en"><link data-rh="true" rel="alternate" href="https://seobie.github.io/blog/회사-프로젝트에-mono-repo-도입기" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://H4X7PLQNZK-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.fc5f5b74.css">
<link rel="preload" href="/assets/js/runtime~main.7cfee921.js" as="script">
<link rel="preload" href="/assets/js/main.8b441e94.js" as="script">
<meta name="google-site-verification" content="VvpyPbzaSXNhApTmBXGcySkg_rUqvRlz2jqE-lkdL4M">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/avatar.png" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/avatar.png" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Seob&#x27;log</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/algorithms">Algorithms</a><a class="navbar__item navbar__link" href="/blog/tags">Tags</a><a class="navbar__item navbar__link" href="/blog/archive">Archive</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/seobie" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">All posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/do-you-know-this">this, 어디까지 알고 있나요?</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/how-to-make-badges-for-github-readme">GitHub Readme에 넣을 뱃지 만들기</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/m1-chip-mac-bundle-install-error">[Error Log] M1 Chip Mac Bundle Install Error</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/how-to-install-jekyll-on-m1-macbook">M1 맥에서 jekyll 설치하기</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/err-package-path-not-exported">[Error Log] ERR_PACKAGE_PATH_NOT_EXPORTED 에러 해결</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/oh-my-zsh-git-plugin-cheatsheet">oh-my-zsh git plugin cheatsheet</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/what-is-enum-and-is-it-good">[TypeScript] enum은 뭐지? 써야할까?</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/git-action-struggles">git action 자동 배포 에러 해결기 (ERROR: Invalid first code point of tag name U+C804.)</a></li><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/blog/회사-프로젝트에-mono-repo-도입기">회사 프로젝트에 mono-repo 도입기</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/정규-표현식-어렵지-않아요-😉">정규 표현식 어렵지 않아요 😉</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/conquer-css-nth-child">[CSS] 알아두면 유용한 nth-child 정복하기 😎(feat. nth-of-type)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/execution-context">[JavaScript] 실행컨택스트 (Execution Context) - 3 (함수 선언문과 함수 표현식)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/Mac-에러-해결기-xcrun:-error:-invalid-active-developer-path">Mac 에러 해결기 (xcrun: error: invalid active developer path)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/[JavaScript]-실행컨택스트-Execution-Context-2">[JavaScript] 실행컨택스트 (Execution Context) - 2 (호이스팅 직접 보고👀  이해하기💡)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/[JavaScript]-실행컨택스트-Execution-Context-1">[JavaScript] 실행컨택스트 (Execution Context) - 1</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/closure-클로저-너-뭐니">Closure (클로저) 너 뭐니?</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="https://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="mono-repo 도입을 결정하게 된 이유"><header><h1 class="title_f1Hy" itemprop="headline">회사 프로젝트에 mono-repo 도입기</h1><div class="container_mt6G margin-vert--md"><time datetime="2021-11-06T00:00:00.000Z" itemprop="datePublished">November 6, 2021</time> · <!-- -->13 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/seobie" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/67283770?v=4" alt="이영섭" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/seobie" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">이영섭</span></a></div><small class="avatar__subtitle" itemprop="description">Frontend Engineer</small></div></div></div></div></header><div id="__blog-post-container" class="markdown" itemprop="articleBody"><h2 id="mono-repo-도입을-결정하게-된-이유">mono-repo 도입을 결정하게 된 이유</h2>
<p>현재 회사에서 리액트로 개발중인 프론트엔드 프로젝트는 3개이다.</p>
<p>최근까지는 모두 다른 Repository에서 개별적으로 관리를 했었는데, 프로젝트가 모두 공통된 디자인과 컴포넌트를 사  용하고 있었기 때문에 A 프로젝트에서 컴포넌트를 수정하면 프로젝트 B와 C에서도 수정을 해줘야만 했다.</p>
<p>하지만 minor한 수정인 경우 제때 수정하지 않게 되거나 업데이트 하는 것을 잊게 되어 한 프로젝트에서만 업데이트되는 상황이 발생했고 나중에는 프로젝트간 차이점을 좁히기가 어려워졌다.</p>
<p>이 문제점을 해결하기 위하여 공통적으로 사용되는 컴포넌트만 따로 분리하여 라이브러리처럼 배포해서 사용하려고도 했었지만 mono-repo라는 개념을 알게 되고 나서, 여러 자료를 리서치해보게 되었고, 지금 나의 상황에 가장 적합하다고 판단하여 mono-repo로 전환을 하기로 정하였다.</p>
<h2 id="mono-repo-">mono-repo? 🤨</h2>
<p>mono의 반대 개념은 multi 이다. (mono 는 하나, multi는 여러개)</p>
<p>기존 프로젝트마다 각자 repository를 갖고 있었으므로 기존의 프로젝트는 multi-repo 라고 보면 된다.</p>
<p>mono-repo는 두 개 이상의 프로젝트를 하나의 repository에서 관리하는 방법이고 이렇게 하게되면 각 프로젝트별로 설치되어야하는 공통된 패키지를 한 곳에서 관리할 수 있게 된다.</p>
<h3 id="mono-repo의-장점">mono-repo의 장점</h3>
<ul>
<li><strong>코드의 재사용</strong> : 현재 프로젝트는 모두 같은 디자인톤을 사용하고 같은 컴포넌트를 사용하고 있었기때문에, 각 repository에 같은 코드를 복붙해야 했다. 하지만 mono-repo에서는 한 곳에 공통으로 쓰이는 것들을 모아두고 각 프로젝트에서 가져다 쓸 수 있기 때문에 코드의 재사용성이 좋아진다.</li>
<li><strong>의존성 관리</strong> : 멀티레포에서는 각 프로젝트마다 <code>typescript</code>, <code>prettier</code>, <code>eslint</code>, <code>husky</code> 등.. 프로젝트 설정에 필요한 외부 라이브러리를 동일하게 설치하고 동일하게 설정해주  어야 했지만, 루트에서 패키지를 관리하게 되어 패키지의 버전이나 의존성 관리가 용이해진다.</li>
</ul>
<h2 id="lerna"><a href="https://github.com/lerna/lerna#about">Lerna</a></h2>
<blockquote>
<p>Splitting up large codebases into separate independently versioned packages is extremely useful for code sharing. However, making changes across many repositories is messy and difficult to track, and testing across repositories becomes complicated very quickly.</p>
<br>
<br>
<p>To solve these (and many other) problems, some projects will organize their codebases into multi-package repositories (sometimes called monorepos). Projects like Babel, React, Angular, Ember, Meteor, Jest, and many others develop all of their packages within a single repository.
<br><br> <strong>Lerna is a tool that optimizes the workflow around managing multi-package repositories with git and npm.</strong> <br><br>
Lerna can also reduce the time and space requirements for numerous copies of packages in development and build environments - normally a downside of dividing a project into many separate NPM packages. See the hoist documentation for details.</p>
</blockquote>
<p><a href="https://github.com/lerna/lerna#about">Lerna 공식문서</a>를 보면 설명이 자세히 나와있는데 핵심은 <strong>bold</strong>처리된 부분이다. git과 npm을 사용하여 multi-repo를 관리하는 작업과정을 최적화하는 도구라고 소개한다.</p>
<p>lerna는 mono-repo의 개념을 구현한 라이브러리로 우리가 잘 아는 facebook의 <code>create-react-app</code>이나, <code>storybook</code> 등 유명한 라이브러리도 러나를 사용중이다.</p>
<h3 id="lerna-repo의-구조">Lerna repo의 구조</h3>
<p>현재 우리 프로젝트의 구조는 이런식으로 구성되어있다.</p>
<pre><code class="language-text">mono-repo-project/
├─ node_modules/
├─ packages/
│  ├─ common/
│  │  ├─ node_modules/
│  │  ├─ ...
│  │  └─ package.json
│  ├ ─ project-1/
│  │  ├─ node_modules/
│  │  ├─ ...
│  │  └─ package.json
│  └─ project-2/
│  │  ├─ node_modules/
│  │  ├─ ...
│  │  └─ package.json
├─ lerna.json
└─ package.json
</code></pre>
<h3 id="자주-사용하는-명령어">자주 사용하는 명령어</h3>
<h4 id="1lerna-bootstrap">1.<a href="https://github.com/lerna/lerna/tree/main/commands/bootstrap"><strong><code>lerna bootstrap</code></strong></a></h4>
<blockquote>
<p>각각의 패키지에 명시된 디펜던시를 설치하고 패키지들 내에서 특정 모듈이 필요로 하는 버전과 실제 모듈 버전이 동일하다면 불필요한 다운로드 없이 서로 심링크를 걸어 로컬에서 사용할 수 있게 해줍니다 (심볼릭링크)</p>
</blockquote>
<p><img src="https://user-images.githubusercontent.com/67283770/140882461-a3a7f6a1-0afb-48cd-ac8f-2062a1e3b65e.png" alt="image"></p>
<p><code>—hoist</code> 옵션(플래그)을 사용한다면 공통되는 모듈을 루트의 <code>node_modules</code> 로 올려서 설치하고, 만약 각각의 패키지가 서로다른 버전의 외부 디펜던시를 사용한다면 가장 많이 사용되고 있는 버전이 호이스팅 되고 관련된 경고를 보여줍니다. 호이스팅을 잘 이용한다면 다음과 같은 이점을 얻을 수 있습니다. (yarn worspaces를 설명할 때 자세히 설명합니다)</p>
<ul>
<li>모든 패키지는 주어진 종속성의 동일한 버전을 사용한다.</li>
<li>GreenKeeper와 같은 자동화 된 도구를 사용하여 루트의 종속성을 최신 상태로 유지할 수 있다.</li>
<li>종속성 설치 시간이 줄어든다.</li>
<li>저장 공간이 덜 필요하다.</li>
</ul>
<h4 id="2lerna-clean">2.<strong><code>lerna clean</code></strong></h4>
<ul>
<li><code>packages</code> 하위 폴더 안에 있는 <code>node_modules</code> 폴더를 삭제한다.</li>
<li>루트의 <code>node_modules</code> 는 삭제하지 않는다.</li>
<li>clean build의 목적으 로 사용</li>
</ul>
<h2 id="yarn-workspace"><a href="https://classic.yarnpkg.com/lang/en/docs/workspaces/">Yarn Workspace</a></h2>
<blockquote>
<p>Workspaces are a new way to set up your package architecture that’s available by default starting from Yarn 1.0. It allows you to setup multiple packages in such a way that you only need to run <code>yarn install</code> once to install all of them in a single pass.</p>
</blockquote>
<ul>
<li>모노레포의 각 패키지마다 가지고 있는 <code>node_modules</code> 가 루트의 <code>node_modules</code> 를 참조한다.</li>
<li>별도의 라이브러리를 설치할 필요 없이 yarn에 내장된 기능이다.</li>
<li><code>yarn install</code> 혹은 <code>yarn</code> 을 실행하면 루트의 package.json안에 명시되어 있는 dependency, 그리고 각 패키지에 명시되어있는 dependency가 중복을 최대한 줄인 채 루트의 node_modules안에 <code>호이스팅</code> 되어서 설치되고 dependency로 명시 되어있는 모듈은 심링크가 걸려 npm에 배포되어있는 버전이 아니라 로컬에 있는 코드를 바로 볼 수 있게 해줍니다.</li>
</ul>
<p><img src="https://miro.medium.com/max/1400/1*uGcDMXSuT1LYa0Ex8kOuaw.png" alt="image">
<em>from <a href="https://classic.yarnpkg.com/">https://classic.yarnpkg.com/</a></em></p>
<h3 id="packagejson-설정">package.json 설정</h3>
<pre><code class="language-json" metastring="title=&quot;package.json&quot;">{
  &quot;name&quot;: &quot;mono-repo&quot;,
  &quot;version&quot;: &quot;1.0.0&quot;,
  &quot;main&quot;: &quot;index.js&quot;,
  &quot;license&quot;: &quot;MIT&quot;,
  &quot;private&quot;: true, // true로 설정되어야 yarn workspace를 사용할 수 있다.
  &quot;workspaces&quot;: {
    &quot;packages&quot;: [
      &quot;packages/*&quot; // workspace 경로 설정
    ]
  },
  &quot;scripts&quot;: {
    &quot;common&quot;: &quot;yarn workspace @mono-repo/common&quot;,
    &quot;project-1&quot;: &quot;yarn workspace @mono-repo/project-1&quot;, // 명 령어를 짧게 하기 위해 추가해줬다.
    ...
  }
}
</code></pre>
<pre><code class="language-json" metastring="title=&quot;packages/common/package.json&quot;">{
  &quot;name&quot;: &quot;@mono-repo/common&quot;, // yarn workspace 에서 쓰일 이름
  &quot;version&quot;: &quot;1.0.0&quot;,
  &quot;main&quot;: &quot;index.js&quot;,
  &quot;license&quot;: &quot;MIT&quot;,
  &quot;private&quot;: true,
  &quot;dependencies&quot;: {
    ...
  },
  &quot;devDependencies&quot;: {
    ...
  },
  ...
}
</code></pre>
<pre><code class="language-json" metastring="title=&quot;packages/project-1/package.json&quot;">{
  &quot;name&quot;: &quot;@mono-repo/project-1&quot;, // yarn workspace 에서 쓰일 이름
  &quot;version&quot;: &quot;1.0.0&quot;,
  &quot;private&quot;: true,
  &quot;dependencies&quot;: {
    &quot;@mono-repo/common&quot;: &quot;1.0.0&quot;, // common 패키지에 접근하기 위해 추가해야한다.
    ...
  },
 ...
}
</code></pre>
<h3 id="특정-패키지에-라이브러리-설치-및-삭제하는법">특정 패키지에 라이브러리 설치 및 삭제하는법</h3>
<pre><code class="language-console">// @mono-repo/project-1 에 react 설치
$ yarn workspace @mono-repo/project-1 add react
// 혹은
$ yarn project-1 add react // package.jsos &gt; scrripts

// @mono-repo/project-1 에서 react 제거
$ yarn workspace @mono-repo/project-1 remove react
// 혹은
$ yarn project-1 remove react

// 루트 package.json &gt; devDependancies에 react 추가
$ yarn add -W -D react
// -W 가 없으면 에러가 발생한다
// error Running this command will add the dependency to the workspace root rather than the workspace itself, which might not be what you want - if you really meant it, make it explicit by running this command again with the -W flag (or --ignore-workspace-root-check).
// info Visit https://yarnpkg.com/en/docs/cli/add for documentation about this command.
</code></pre>
<h3 id="tsconfigpathsjson-설정">tsconfig.paths.json 설정</h3>
<p>프로젝트가 모두 <code>typescript</code>를 사용하고 있으므로 <code>tsconfig.json</code>도 설정해주어야 한다.</p>
<pre><code class="language-json" metastring="title=&quot;packages/project-1/tsconfig.paths.json&quot;">{
  &quot;compilerOptions&quot;: {
    &quot;baseUrl&quot;: &quot;./src&quot;,
    &quot;paths&quot;: {
      &quot;@mono-repo/common/*&quot;: [&quot;../../common/src/*&quot;],
      ...
    }
  }
}
</code></pre>
<pre><code class="language-json" metastring="title=&quot;packages/project-1/tsconfig.json&quot;">{
  &quot;extends&quot;: &quot;./tsconfig.paths.json&quot;,
  &quot;compilerOptions&quot;: {
    ...
  },
  ...
}
</code></pre>
<h2 id="craco"><a href="https://github.com/gsoft-inc/craco/blob/master/packages/craco/README.md#craco--">CRACO</a></h2>
<blockquote>
<p>Create React App Configuration Override is an easy and comprehensible configuration layer for create-react-app.</p>
<br>
<br>
<p>Get all the benefits of create-react-app and customization without using &#x27;eject&#x27; by adding a single configuration (e.g. craco.config.js) file at the root of your application and customize your eslint, babel, postcss configurations and many more.</p>
<br>
<br>
<p>All you have to do is create your app using create-react-app and customize the configuration file.</p>
</blockquote>
<h3 id="cracojson-설정">craco.json 설정</h3>
<p><code>project-1</code> , <code>project-2</code> 모두 CRA 템플릿 베이스의 프로젝트라고 한다면, CRA 프로젝트의 CRA config에서는 <code>src</code> 폴더보다 상위의 폴더에서 파일을 <code>import</code> 할 수 없도록 설정이 되어있어서 config를 overide 해주어야한다.</p>
<h3 id="craco-설치">craco 설치</h3>
<pre><code class="language-console">$ yarn workspace project-1 add @craco/craco
## OR
$ npm project-1 add @craco/craco
</code></pre>
<p><code>craco.config.js</code>파일을 프로젝트 루트(<code>packages/project-1</code>)에 생성하고 <code>package.json</code> 파일 안에 <code>scripts</code>를 다음과 같이 수정해준다.</p>
<pre><code class="language-diff" metastring="title=&quot;packages/project-1/package.json&quot;">&quot;scripts&quot;: {
-   &quot;start&quot;: &quot;react-scripts start&quot;,
+   &quot;start&quot;: &quot;craco start&quot;,
-   &quot;build&quot;: &quot;react-scripts build&quot;,
+   &quot;build&quot;: &quot;craco build&quot;
-   &quot;test&quot;: &quot;react-scripts test&quot;,
+   &quot;test&quot;: &quot;craco test&quot;
}
</code></pre>
<pre><code class="language-js" metastring="title=&quot;packages/project-1/craco.config.js&quot;">const TsconfigPathsPlugin = require(&#x27;tsconfig-paths-webpack-plugin&#x27;);
const ForkTSCheckerWebpackPlugin = require(&#x27;fork-ts-checker-webpack-plugin&#x27;);

module.exports = {
  eslint: { enable: false },
  webpack: {
    configure: (config) =&gt; {
      // Remove ModuleScopePlugin which throws when we try to import something
      // outside of src/.
      config.resolve.plugins.pop();

      // Resolve the path aliases.
      config.resolve.plugins.push(new TsconfigPathsPlugin());

      // Let Babel compile outside of src/.
      const oneOfRule = config.module.rules.find((rule) =&gt; rule.oneOf);
      const tsRule = oneOfRule.oneOf.find((rule) =&gt;
        rule.test.toString().includes(&#x27;ts|tsx&#x27;)
      );

      tsRule.include = undefined;
      tsRule.exclude = /node_modules/;

      return config;
    },
    plugins: {
      remove: [
        // This plugin is too old and causes problems in monorepos. We&#x27;ll
        // replace it with a newer version.
        &#x27;ForkTsCheckerWebpackPlugin&#x27;,
      ],
      add: [
        // Use newer version of ForkTSCheckerWebpackPlugin to type check
        // files across the monorepo.
        new ForkTSCheckerWebpackPlugin({
          issue: {
            // The exclude rules are copied from CRA.
            exclude: [
              {
                file: &#x27;**/src/**/__tests__/**&#x27;,
              },
              {
                file: &#x27;**/src/**/?(*.)(spec|test).*&#x27;,
              },
              {
                file: &#x27;**/src/setupProxy.*&#x27;,
              },
              {
                file: &#x27;**/src/setupTests.*&#x27;,
              },
            ],
          },
        }),
      ],
    },
  },
  jest: {
    configure: {
      moduleDirectories: [&#x27;&lt;rootDir&gt;/&#x27;, &#x27;src&#x27;, &#x27;node_modules&#x27;],
      moduleNameMapper: {
        &#x27;^.+\\.(scss)$&#x27;: &#x27;&lt;rootDir&gt;/../hrm-frontend/src/mocks/styleMock.js&#x27;,
        // &#x27;^.+\\.(gif|ttf|eot|svg|png)$&#x27;:
        //   &#x27;&lt;rootDir&gt;/../packages/hrm-frontend/src/mocks/fileMock.ts&#x27;,
        &#x27;^@inssait-mono-repo/common/(.*)$&#x27;: [
          &#x27;&lt;rootDir&gt;/../common/src/$1.ts&#x27;,
          &#x27;&lt;rootDir&gt;/../common/src/$1.tsx&#x27;,
        ],
      },
    },

    //Jest can not find any module with absoulte path without this option include &quot;src&quot;
    transformIgnorePatterns: [
      &#x27;/node_modules/(?!antd|@ant-design|rc-.+?|@babel/runtime).+(js|jsx)$&#x27;,
    ],
    collectCoverageFrom: [
      &#x27;./src/components/**/*.tsx&#x27;,
      &#x27;./src/features/**/*.ts&#x27;,
      &#x27;./src/pages/**/*.tsx&#x27;,
      &#x27;./src/pages/**/*.ts&#x27;,
    ],
  },
};
</code></pre>
<h4 id="참고한-글">참고한 글</h4>
<ul>
<li><a href="https://medium.com/wantedjobs/lerna%EC%99%80-yarn-workspaces%EB%A5%BC-%ED%99%9C%EC%9A%A9%ED%95%9C-%ED%8C%A8%ED%82%A4%EC%A7%80-%EA%B4%80%EB%A6%AC-429d2a685486">Lerna와 Yarn workspaces를 활용한 패키지 관리</a></li>
<li><a href="https://lerna.js.org/">Lerna · A tool for managing JavaScript projects with multiple packages.</a></li>
<li><a href="https://musma.github.io/2019/04/02/yarn-workspaces.html">[Node] yarn workspaces (프로젝트 참조)</a></li>
<li><a href="https://jojoldu.tistory.com/585">Lerna와 yarn-workspace를 활용한 Mono Repo (Typescript &amp; Jest) 환경 구성하기</a></li>
<li><a href="https://medium.com/devityoself/monorepo-eslint-vscode-6f5982c8404d">Monorepo eslint vscode</a></li>
<li><a href="https://www.linkedin.com/pulse/microfrontends-integrating-create-react-app-cra-eject-rany?trk=articles_directory">Microfrontends: Integrating with a create-react-app (CRA) project without eject using CRACO (Create-React-App Configuration Override)</a></li>
<li><a href="https://medium.com/@deptno/monorepo-yarn-workspace-e81e3e078100">Monorepo? Yarn Workspace!</a></li>
<li><a href="https://medium.com/@deptno/%ED%83%80%EC%9E%85%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8-%EB%AA%A8%EB%85%B8%EB%A0%88%ED%8F%AC-8ba1f1757345">타입스크립트 모노레포</a></li>
<li><a href="https://kdydesign.github.io/2020/08/27/mono-repo-lerna-example/">Lerna를 활용한 Mono-Repo 구축 완벽 가이드 - 예제를 통한 완벽 파악</a></li>
<li><a href="https://github.com/gsoft-inc/craco/blob/master/packages/craco/README.md#installation">craco/README.md at master · gsoft-inc/craco</a></li>
<li><a href="https://valcker.medium.com/configuring-typescript-monorepo-with-eslint-prettier-and-webstorm-61a71f218104">Configuring TypeScript Monorepo with ESLint, Prettier and WebStorm</a></li>
<li><a href="https://awesomezero.com/development/lerna_and_yarn_workspace/">Lerna와 Yarn workspaces를 활용한 패키지 관리 - zero&#x27;s 이모저모</a></li>
<li><a href="https://frontend-digest.com/using-create-react-app-in-a-monorepo-a4e6f25be7aa">Using Create-React-App In A Monorepo</a></li>
<li><a href="https://medium.com/@deptno/monorepo-yarn-workspace-e81e3e078100">Monorepo? Yarn Workspace!</a></li>
<li><a href="https://velog.io/@younuk23/React-Native-CRA-MonoRepo-%ED%99%98%EA%B2%BD-%EA%B5%AC%EC%B6%95%ED%95%98%EA%B8%B0">React-Native + CRA MonoRepo 환경 구축하기</a></li>
<li><a href="https://medium.com/@NiGhTTraX/how-to-set-up-a-typescript-monorepo-with-lerna-c6acda7d4559">How to set up a TypeScript monorepo with Lerna</a></li>
</ul></div><footer class="row docusaurus-mt-lg blogPostFooterDetailsFull_mRVl"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/mono-repo">mono-repo</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/lerna">lerna</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/yarn-workspace">yarn workspace</a></li></ul></div><div class="col margin-top--sm"><a href="https://github.com/seobie/seobie.github.io/tree/main/blog/2021/11/2021-11-06-mono-repo-introduction.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/git-action-struggles"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">git action 자동 배포 에러 해결기 (ERROR: Invalid first code point of tag name U+C804.)</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/정규-표현식-어렵지-않아요-😉"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">정규 표현식 어렵지 않아요 😉</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#mono-repo-도입을-결정하게-된-이유" class="table-of-contents__link toc-highlight">mono-repo 도입을 결정하게 된 이유</a></li><li><a href="#mono-repo-" class="table-of-contents__link toc-highlight">mono-repo? 🤨</a><ul><li><a href="#mono-repo의-장점" class="table-of-contents__link toc-highlight">mono-repo의 장점</a></li></ul></li><li><a href="#lerna" class="table-of-contents__link toc-highlight">Lerna</a><ul><li><a href="#lerna-repo의-구조" class="table-of-contents__link toc-highlight">Lerna repo의 구조</a></li><li><a href="#자주-사용하는-명령어" class="table-of-contents__link toc-highlight">자주 사용하는 명령어</a></li></ul></li><li><a href="#yarn-workspace" class="table-of-contents__link toc-highlight">Yarn Workspace</a><ul><li><a href="#packagejson-설정" class="table-of-contents__link toc-highlight">package.json 설정</a></li><li><a href="#특정-패키지에-라이브러리-설치-및-삭제하는법" class="table-of-contents__link toc-highlight">특정 패키지에 라이브러리 설치 및 삭제하는법</a></li><li><a href="#tsconfigpathsjson-설정" class="table-of-contents__link toc-highlight">tsconfig.paths.json 설정</a></li></ul></li><li><a href="#craco" class="table-of-contents__link toc-highlight">CRACO</a><ul><li><a href="#cracojson-설정" class="table-of-contents__link toc-highlight">craco.json 설정</a></li><li><a href="#craco-설치" class="table-of-contents__link toc-highlight">craco 설치</a></li></ul></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.instagram.com/x.eob" target="_blank" rel="noopener noreferrer" class="footer__link-item">Instagram<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/seobie" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Yeongseob Lee, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.7cfee921.js"></script>
<script src="/assets/js/main.8b441e94.js"></script>
</body>
</html>